# 🛒 Demo EC Store (Client Site)

マーケティングツールの動作を検証・シミュレーションするためのデモ用ECサイトです。Elasticsearchによる高度な検索機能と、SaaS側と連動したインテリジェントな行動解析機能を備えています。

## 🎯 役割
- **高度な検索体験**: Elasticsearchを使用したミリ秒単位の集計・ハイライト表示。
- **行動データの収集**: `Tracker.tsx` および `search/page.tsx` によるリアルタイムなイベント送信。
- **インサイト連動型UI**: SaaS側の解析結果（節約志向スコア等）に応じた、動的なUI（ポップアップ）の出し分け。

## 🔍 検索・パーソナライズ仕様 (Elasticsearch & Insight)
- **リアルタイム検索**: デバウンス処理（500ms）と `dangerouslySetInnerHTML` によるヒット箇所のハイライト。
- **自律型パーソナライズ**: `localStorage` を活用した「推しカテゴリ」の `pref` 送信。
- **📍 インサイト解析 (Behavioral Scoring)**: 
    - **価格感受性スコアリング**: ユーザーが検索結果で「価格の安い順」を選択するとスコアを加算(+10)、「高い順」なら減算(-10)。
    - **動的セグメンテーション**: スコアが **30以上** に達したユーザーを「節約家」と自動判定。
    - **デザイン出し分け**: 判定されたユーザーには、通常とは異なる「オレンジ枠（INSIGHT MATCH）」のポップアップを優先表示。

## 🔌 マーケティングツールとの連携
1. **行動トラッキング**: `POST http://localhost:3001/api/v1/track` へソート条件等のイベントを送信。
2. **インサイト同期**: `useEffect` 内でSaaS側の解析結果を受け取り、最新のセグメントに基づいた接客を実行。
3. **二重表示防止**: 外部スニペットによる自動配信を停止し、解析結果に基づく一本化された配信制御を実現。