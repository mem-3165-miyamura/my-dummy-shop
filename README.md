# ■■■ ダミーECサイト側 (Port: 3000) README.md ■■■

# 🛒 Demo EC Store (Client Site)

マーケティングツールの動作を検証・シミュレーションするためのデモ用ECサイトです。Elasticsearchによる高速検索機能を備えています。

## 🎯 役割
- **スニペットの実行**: 3001番サーバーから配信される計測タグの読み込み。
- **ポップアップのレンダリング**: 配信条件にマッチした際の自動表示。
- **高速商品検索**: Elasticsearchを使用した、入力即反映のダイレクト検索体験。
- **コンバージョン計測**: 商品閲覧やフォーム入力時のイベント送信テスト。

## 🔍 検索機能の仕様 (Elasticsearch)
- **リアルタイム更新**: `use client` とデバウンス処理による、ページ遷移なしの検索結果反映。
- **日本語最適化**: `wildcard` クエリにより「パーカー」で「マウンテンパーカー」をヒットさせる部分一致に対応。
- **外部データ同期**: 3001番（マーケツール）の商品マスターを正本として同期するアーキテクチャ。

## 🔌 マーケティングツールとの連携方法
このサイトの layout.tsx 等の共通ヘッダーに、以下のスクリプトタグが埋め込まれています。

<script src="http://localhost:3001/api/v1/snippet?uid=YOUR_USER_ID"></script>

## 🚀 起動方法
1. インフラ起動: `docker-compose up -d` (Elasticsearch)
2. 依存関係のインストール: npm install
3. 開発サーバーの起動: npm run dev (Port: 3000)

## 🧪 テスト項目
- 検索窓に「パーカー」等を入力し、ダイレクトに結果が切り替わるか。
- ページをリロードしてポップアップが表示されるか。
- ポップアップのボタンをクリックして、管理画面側のクリック数が増えるか。
- メールアドレス入力フォーム等で identify イベントが正しく飛ぶか。